@page "/"
@using Microsoft.AspNetCore.Authorization
@using FrontEnd.Services
@using Microsoft.AspNetCore.Components
@attribute [Authorize]

@inject IRoleService RoleService
@inject NavigationManager NavigationManager

<PageTitle>Home</PageTitle>

<h1>Welcome to Project Coordinator</h1>

<p>
    Diese Anwendung soll die Projektkoordination vereinfachen. Aktuell bietet sie lediglich die Möglichkeit die
    Reisedauer von gespeicherten Orten zu berechnen, um zu sehen, wer am besten geeignet ist.
</p>

<p>
    Da du diese Seite siehst, ist vermutlich etwas nicht in Ordnung. Warte eine kurze Zeit, klicke auf Home im
    Navigationsmenü oder melde dich ab und wieder an. Sollte das Problem weiterhin bestehen, kontaktiere bitte den
    "Support".
</p>

@code {
    protected override async Task OnInitializedAsync()
    {
        try
        {
            var roles = await RoleService.GetUserRolesAsync();
            if (roles.Contains("projectcoordination", StringComparer.OrdinalIgnoreCase))
            {
                NavigationManager.NavigateTo("/trips");
            }
        }
        catch
        {
            // If role check fails, stay on home page
        }
    }
}