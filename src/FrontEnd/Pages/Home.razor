@page "/"
@using Microsoft.AspNetCore.Authorization
@using FrontEnd.Services
@using Microsoft.AspNetCore.Components
@attribute [Authorize]

@inject IRoleService RoleService
@inject NavigationManager NavigationManager

<PageTitle>Projectcoordinator</PageTitle>

<h1>Willkommen beim Projektkoordinator</h1>

<div class="row mt-4">
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">
                    <span class="bi bi-geo-alt-fill text-primary"></span> Reisen berechnen
                </h5>
                <p class="card-text">
                    Berechne automatisch die Reisedauer von allen gespeicherten Orten zu einem Zielort.
                    So findest du schnell heraus, wer am besten geeignet ist, einen Workshop wahrzunehmen.
                </p>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="card mb-4">
            <div class="card-body">
                <h5 class="card-title">
                    <span class="bi bi-pin-map-fill text-success"></span> Orte verwalten
                </h5>
                <p class="card-text">
                    Speichere und verwalte deine häufig besuchten Orte. Diese Orte werden für die
                    Reiseberechnung verwendet, um optimale Zuordnungen zu finden.
                </p>
            </div>
        </div>
    </div>
</div>

<div class="alert alert-info mt-4" role="alert">
    <strong>Hinweis:</strong> Du siehst diese Seite, weil du noch keine Rolle zugewiesen bekommen hast oder die
    Anwendung gerade lädt.
    Warte einen Moment, klicke auf Home im Navigationsmenü oder melde dich ab und wieder an.
    Sollte das Problem weiterhin bestehen, kontaktiere bitte den Support.
</div>

@code {
    protected override async Task OnInitializedAsync()
    {
        try
        {
            if (await RoleService.HasRole("projectcoordination"))
            {
                NavigationManager.NavigateTo("/trips");
            }
        }
        catch
        {
            // If role check fails, stay on home page
        }
    }
}